<div class="container">
  <div class="row">
    <div class="col-md-4"></div>
    <div class="col-md-4"></div>
    <div class="col-md-4">
      <select
        [(ngModel)]="selectedSort"
        class="form-select"
        aria-label="Default select example"
        (change)="applySort(selectedSort)"
      >
        <option [value]="i" *ngFor="let sor of sort; let i = index">
          {{ sor.name }}
        </option>
      </select>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-2">
      <h4>Filter</h4>
      <hr />
      <div>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="selectedFilters.search"
          (input)="applySearch()"
          placeholder="search"
        />
        <strong>Category</strong>

        <ul class="my-2 list-unstyled">
          <li *ngFor="let category of categories" class="text-wrap">
            <input
              type="checkbox"
              class="form-check"
              [checked]="check === category._id"
              (change)="filterCategory($event, category._id)"
            />
            {{ category.categoryName }}
          </li>
        </ul>
      </div>
      <hr />
      <div>
        <strong>Price Range</strong>

        <ul class="my-2 list-unstyled">
          <li *ngFor="let pric of ranges; let i = index">
            <ng-container *ngIf="i !== ranges.length - 1">
              <input
                type="checkbox"
                class="form-check"
                (change)="applyPriceRange($event, ranges[i], ranges[i + 1])"
              />
              {{ ranges[i] }} - {{ ranges[i + 1] }}
            </ng-container>
          </li>
        </ul>
      </div>
      <hr />
      <div>
        <strong>Discount Range</strong>

        <ul class="my-2 list-unstyled">
          <li *ngFor="let dis of discounts">
            <input
              class="form-check"
              type="checkbox"
              (change)="applyDiscount($event, dis)"
            />
            {{ dis }}% Over
          </li>
        </ul>
      </div>
      <hr />
      <div>
        <strong>Rating Range</strong>

        <ul class="my-2 list-unstyled">
          <li *ngFor="let rating of [1, 2, 3, 4]">
            <input
              class="form-check"
              type="checkbox"
              (click)="applyRating($event, rating)"
            />
            <app-star-rating
              [rating]="rating"
              [readonly]="true"
            ></app-star-rating>
          </li>
        </ul>
      </div>
    </div>
    <div class="col-lg-10">
      <div class="row row-cols-1 row-cols-md-3 g-2 my-3 px-5">
        <ng-container *ngFor="let cate of products; let i = index">
          <div class="col-lg-4">
            <div class="card h-100 border border-1 rounded-3">
              <div class="card-body d-flex flex-column justify-content-between">
                <div class="image-container">
                  <img
                    [src]="cate.image"
                    class="card-img-top"
                    alt="Category Image"
                  />
                </div>
                <div class="card-text mt-3">
                  <p (click)="nav(cate._id)" class="fw-bold">
                    {{ cate.title }}
                  </p>
                  <app-star-rating
                    [rating]="cate.totalrating ?? 0"
                    [readonly]="true"
                  ></app-star-rating>
                  <p>
                    {{ cate.amount }}
                    <span class="text-decoration-line-through"
                      >{{ cate.price }} ({{ cate.discount }}% off)</span
                    >
                  </p>
                  <button (click)="addWish(cate._id)" class="btn btn-success">
                    Like
                  </button>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
      <div class="d-flex justify-content-center my-4">
        <ng-container *ngIf="pageNo.length > 1">
          <button
            class="btn btn-link"
            *ngIf="selectedFilters > 1"
            (click)="
              selectedFilters.page = selectedFilters.page - 1; applySearch()
            "
          >
            &#xAB; Previous
          </button>
          <button
            class=" btn {{
              selectedFilters.page === i + 1 ? 'active' : 'btn-link'
            }}"
            *ngFor="let _ of pageNo; let i = index"
            (click)="selectedFilters.page = _; applySearch()"
          >
            {{ i + 1 }}
          </button>
          <button
            *ngIf="selectedFilters.page < pageNo.length"
            class="btn btn-link"
            (click)="
              selectedFilters.page = selectedFilters.page + 1; applySearch()
            "
          >
            Next &#xBB;
          </button>
        </ng-container>
      </div>
    </div>
  </div>
</div>
